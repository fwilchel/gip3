<?xml version="1.0" encoding="UTF-8"?>
<ui:composition 
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:p="http://primefaces.org/ui"
  xmlns:misc="http://java.sun.com/jsf/composite/misc"
  template="/ui/templates/general.xhtml">

  <ui:define 
    name="title">.::Interfaz entre ICG y SAP::. .::#{msg.UsuarioAdminUsuariosTitulo}::.
  </ui:define>

  <ui:define 
    name="contenido">

    <p:spacer 
      height="40"/>

    <h:form 
      id="forma"
      prependId="false" >

      <p:messages 
        id="msgs" />

      <p:tabView 
        id="pnlTab">

        <p:tab 
          title="#{msg.gfTitle}">

          <p:panel
            id="pnlFtlDocumentos">
            <p:panelGrid
              columns="3">
              <p:outputLabel 
                for="filtroFechaActual" 
                value="#{msg.generalFechaActual}" 
                styleClass="negrita"/>
              <h:outputText
                id="filtroFechaActual"
                value="#{generarFacturaMB.fechaActual}">
                <f:convertDateTime 
                  pattern="dd/MM/yyyy hh:mm:ss a"/>
              </h:outputText>
              <p:message
                for="filtroFechaActual"/>
              <p:outputLabel 
                for="filtroConsecutivoDocumento" 
                value="#{msg.gfFltLblConsecutivo}" 
                styleClass="negrita"/>
              <p:inputText 
                id="filtroConsecutivoDocumento" 
                value="#{generarFacturaMB.consecutivoDocumento}" 
                maxlength="40" 
                label="#{msg.gfFltLblConsecutivo}"/>
              <p:message
                for="filtroConsecutivoDocumento"/>
              <p:outputLabel 
                for="filtroTipoFactura" 
                value="#{msg.gfFltLblTipoFactura} " 
                styleClass="negrita"/>
              <p:selectOneMenu 
                id="filtroTipoFactura" 
                value="#{generarFacturaMB.tipoFacturaSeleccionado}">
                <f:selectItems 
                  value="#{generarFacturaMB.listaTiposFacturas}" 
                  var="tipoFactura"
                  itemLabel="#{tipoFactura.label}"
                  itemValue="#{tipoFactura.value}"/>
              </p:selectOneMenu>
              <p:message
                for="filtroTipoFactura"/>
              <f:facet
                name="footer">
                <p:commandButton
                  value="#{msg.gfFltBtnBuscar}"
                  actionListener="#{generarFacturaMB.buscar()}"
                  update="tblDocumentos"/>
              </f:facet>
            </p:panelGrid>
          </p:panel>

          <p:dataTable 
            id="tblDocumentos"
            var="documento" 
            widgetVar="tblDocumentos" 
            value="#{generarFacturaMB.listaDocumentos}" 
            rows="10"
            emptyMessage="#{msg.generalNoDatos}" 
            paginator="true"
            paginatorPosition="bottom"
            paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
            rowsPerPageTemplate="5,10,15">

            <f:facet 
              name="header">
              <div 
                align="right">
                <p:outputPanel>
                  <h:outputText 
                    value="#{msg.generalBuscarTodosCampos}: " />
                  <p:inputText 
                    id="globalFilter"
                    onkeyup="PF('tblDocumentos').filter()" 
                    style="width:150px"
                    placeholder="#{msg.generalPalabrasBuscar}" />
                  <p:spacer 
                    width="30">
                  </p:spacer>				
                  <p:commandButton 
                    action="introduccion" 
                    title="#{msg.generalCancelar}" 
                    ajax="false"
                    icon="ui-icon-cancel" 
                    value="#{msg.generalCancelar}" />
                </p:outputPanel>
              </div>
            </f:facet>

            <!-- opcion de generar factura -->
            <p:column 
              style="width:32px;text-align: center">
              <p:commandButton 
                icon="ui-icon-pencil" 
                title="#{msg.gfBtnVerDetalle}"
                actionListener="#{generarFacturaMB.seleccionarRemision(documento)}"
                oncomplete="PF('dlgDetalle').show()"
                update=":dlgDetalle"/>
            </p:column>

            <!-- Documento -->
            <p:column   
              headerText="#{msg.gfTblColDocumento}"
              sortBy="#{documento.id}"
              filterBy="#{documento.id}"
              filterMatchMode="contains">
              <h:outputText 
                value="#{documento.id}" />
            </p:column>

            <!-- consecutivo factura -->
            <p:column 
              headerText="#{msg.gfTblColConsecutivo}"
              sortBy="#{documento.consecutivoDocumento}"
              filterBy="#{documento.consecutivoDocumento}"
              filterMatchMode="contains">
              <h:outputText 
                value="#{documento.consecutivoDocumento}" />
            </p:column>

            <!-- fecha generacion -->
            <p:column 
              headerText="#{msg.gfTblColFechaGeneracion}"
              sortBy="#{documento.fechaGeneracion}"
              filterBy="#{documento.fechaGeneracion}"
              filterMatchMode="contains">
              <h:outputText 
                value="#{documento.fechaGeneracion}" >
                <f:convertDateTime 
                  pattern="dd-MMM-yyyy"/>
              </h:outputText>
            </p:column>

          </p:dataTable>

        </p:tab>

      </p:tabView>

    </h:form>

    <p:dialog 
      id="dlgDetalle" 
      widgetVar="dlgDetalle" 
      header="#{msg.iieTitle}" 
      resizable="false" 
      showEffect="clip" 
      hideEffect="clip"
      modal="true"
      dynamic="true">
      <p:ajax 
        event="close" 
        listener="#{generarFacturaMB.cancelar()}" />
      <ui:remove>
        <h:form
          id="formaDetalle"
          prependId="false">
          <p:panel 
            id="pnlDetalle">
            <p:outputPanel 
              style="margin-bottom:20px; text-align:left;" >
              <p:panelGrid 
                columns="4"
                styleClass="noBorders">
                <p:outputLabel 
                  for="nombreCliente"
                  value="#{msg.iieDtlLblCliente}"
                  styleClass="negrita"/>
                <h:inputText
                  id="nombreCliente"
                  value="#{generarFacturaMB.seleccionado.clienteNombre}" 
                  disabled="true"
                  styleClass="filas_contenido"/>
                <p:outputLabel 
                  for="direccionCliente"
                  value="#{msg.iieDtlLblDireccion}"
                  styleClass="negrita"/>
                <h:inputText
                  id="direccionCliente"
                  value="#{generarFacturaMB.seleccionado.clienteDireccion}" 
                  disabled="true"
                  styleClass="filas_contenido"/>
                <p:outputLabel 
                  for="telefonoCliente"
                  value="#{msg.iieDtlLblTelefono}"
                  styleClass="negrita"/>
                <h:inputText
                  id="telefonoCliente"
                  value="#{generarFacturaMB.seleccionado.clienteTelefono}" 
                  disabled="true"
                  styleClass="filas_contenido"/>
                <p:outputLabel 
                  for="contactoCliente"
                  value="#{msg.iieDtlLblContacto}"
                  styleClass="negrita"/>
                <h:inputText
                  id="contactoCliente"
                  value="#{generarFacturaMB.seleccionado.clienteContacto}" 
                  disabled="true"
                  styleClass="filas_contenido"/>
                <p:outputLabel 
                  for="ciudadCliente"
                  value="#{msg.iieDtlLblCiudad}"
                  styleClass="negrita"/>
                <h:inputText
                  id="ciudadCliente"
                  value="#{generarFacturaMB.seleccionado.clienteCiudad}" 
                  disabled="true"
                  styleClass="filas_contenido"/>
                <p:outputLabel 
                  for="paisCliente"
                  value="#{msg.iieDtlLblPais}"
                  styleClass="negrita"/>
                <h:inputText
                  id="paisCliente"
                  value="#{generarFacturaMB.seleccionado.clientePais}" 
                  disabled="true"
                  styleClass="filas_contenido"/>
              </p:panelGrid>
            </p:outputPanel>
            <!---->
            <p:outputPanel
              style="margin-bottom:20px">
              <p:dataTable 
                id="tblFacturas"
                var="factura" 
                value="#{generarFacturaMB.seleccionado.listaFacturas}" 
                emptyMessage="#{msg.generalNoDatos}" 
                paginator="false">
                <!-- Factura -->
                <p:column   
                  headerText="#{msg.iieDtlTblClmFactura}">
                  <h:outputText 
                    value="#{factura.factura}" />
                </p:column>
                <!-- Lote -->
                <p:column   
                  headerText="#{msg.iieDtlTblClmLote}">
                  <h:outputText 
                    value="#{factura.lote}" />
                </p:column>
                <!-- Descripciï¿½n -->
                <p:column   
                  headerText="#{msg.iieDtlTblClmDescripcion}">
                  <h:outputText 
                    value="#{factura.descripcion}" />
                </p:column>
                <!-- Cantidad Cajas -->
                <p:column   
                  headerText="#{msg.iieDtlTblClmCantidadCajas}"
                  styleClass="derecha">
                  <h:outputText 
                    value="#{factura.cantCajas}" >
                    <f:convertNumber 
                      maxFractionDigits="2" 
                      minFractionDigits="2"/>
                  </h:outputText>
                </p:column>
                <!-- Pedido No. -->
                <p:column   
                  headerText="#{msg.iieDtlTblClmPedidoNo}">
                  <h:outputText 
                    value="#{factura.pedidoNum}" />
                </p:column>
                <!-- Asignaciï¿½n No. -->
                <p:column   
                  headerText="#{msg.iieDtlTblClmAsignacionNo}">
                  <h:outputText 
                    value="#{factura.asignacionNum}" />
                </p:column>
                <!-- Aviso No. -->
                <p:column   
                  headerText="#{msg.iieDtlTblClmAvisoNo}">
                  <h:outputText 
                    value="#{factura.avisoNum}" />
                </p:column>
              </p:dataTable>
            </p:outputPanel>
            <!---->
            <p:outputPanel 
              style="margin-bottom:20px; text-align:right;" >
              <p:panelGrid 
                columns="2"
                styleClass="noBorders">
                <!-- Sociedad de Intermediaciï¿½n Aduanera No.1 -->
                <p:outputLabel 
                  for="sociedadIntermediacionAduanera1"
                  value="#{msg.iieDtlLblSociedadIntermediacionAduanera1}"
                  styleClass="negrita"/>
                <h:inputText
                  id="sociedadIntermediacionAduanera1"
                  value="#{generarFacturaMB.seleccionado.agenteAduana1Nombre}" 
                  disabled="true"
                  styleClass="filas_contenido"/>
                <!-- Sociedad de Intermediaciï¿½n Aduanera No.2 -->
                <p:outputLabel 
                  for="sociedadIntermediacionAduanera2"
                  value="#{msg.iieDtlLblSociedadIntermediacionAduanera2}"
                  styleClass="negrita"/>
                <h:inputText
                  id="sociedadIntermediacionAduanera2"
                  value="#{generarFacturaMB.seleccionado.agenteAduana2Nombre}" 
                  disabled="true"
                  styleClass="filas_contenido"/>
                <!-- Mes de Embarque -->
                <p:outputLabel 
                  for="mesEmbarque"
                  value="#{msg.iieDtlLblMesEmbarque}"
                  styleClass="negrita"/>
                <h:inputText
                  id="mesEmbarque"
                  value="#{generarFacturaMB.seleccionado.mesEmbarque}" 
                  disabled="true"
                  styleClass="filas_contenido"/>
                <!-- Puerto de Embarque -->
                <p:outputLabel 
                  for="puertoEmbarque"
                  value="#{msg.iieDtlLblPuertoEmbarque}"
                  styleClass="negrita"/>
                <h:inputText
                  id="puertoEmbarque"
                  value="#{generarFacturaMB.seleccionado.puertoEmbarque}" 
                  disabled="true"
                  styleClass="filas_contenido"/>
                <!-- Fecha de Embarque -->
                <p:outputLabel 
                  for="fechaEmbarque"
                  value="#{msg.iieDtlLblFechaEmbarque}"
                  styleClass="negrita"/>
                <h:inputText
                  id="fechaEmbarque"
                  value="#{generarFacturaMB.seleccionado.fechaEmbarque}" 
                  disabled="true"
                  styleClass="filas_contenido">
                  <f:convertDateTime 
                    pattern="dd-MMM-yyyy"/>
                </h:inputText>
                <!-- Naviera -->
                <p:outputLabel 
                  for="naviera"
                  value="#{msg.iieDtlLblNaviera}"
                  styleClass="negrita"/>
                <h:inputText
                  id="naviera"
                  value="#{generarFacturaMB.seleccionado.naviera}" 
                  disabled="true"
                  styleClass="filas_contenido"/>
              </p:panelGrid>
            </p:outputPanel>
            <!-- botones -->
            <f:facet
              name="footer">
              <!-- Imprimir Instruccion de Embarque -->
              <p:commandButton 
                value="#{msg.iieDtlBtnImprimirInstruccionEmbarque}" 
                ajax="false" 
                icon="ui-icon-document">
                <p:fileDownload 
                  value="#{generarFacturaMB.generarFacturaMB()}" />
              </p:commandButton>
              <!-- cancelar -->
              <p:commandButton 
                value="#{msg.generalCerrar}" 
                styleClass="ui-confirmdialog-no" 
                icon="ui-icon-close" 
                actionListener="#{generarFacturaMB.cancelar()}"
                oncomplete="PF('dlgDetalle').hide()"
                update=":forma:msgs"/>
            </f:facet>
          </p:panel>

        </h:form>          

      </ui:remove>
    </p:dialog>

  </ui:define>

</ui:composition>