<?xml version="1.0" encoding="UTF-8"?>
<ui:composition 
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:p="http://primefaces.org/ui"
  xmlns:misc="http://java.sun.com/jsf/composite/misc"
  template="/ui/templates/general.xhtml">

  <ui:define 
    name="title">.::Interfaz entre ICG y SAP::. .::#{msg.UsuarioAdminUsuariosTitulo}::.
  </ui:define>

  <ui:define 
    name="contenido">

    <p:spacer 
      height="40"/>

    <h:form 
      id="forma"
      prependId="false" >

      <p:messages 
        id="msgs" />

      <p:tabView 
        id="pnlTab">

        <p:tab 
          title="#{msg.dtbTitle}">

          <p:panel>

            <p:panel
              id="pnlFtlDocumentos">
              <p:panelGrid
                columns="3"
                styleClass="noBorders">
                <!--filtroFechaActual-->
                <p:outputLabel 
                  for="filtroFechaActual" 
                  value="#{msg.generalFechaActual}" 
                  styleClass="negrita"/>
                <h:outputText
                  id="filtroFechaActual"
                  value="#{devolucionTiendaBodegaMB.fechaActual}">
                  <f:convertDateTime 
                    pattern="dd/MM/yyyy hh:mm:ss a"/>
                </h:outputText>
                <p:message
                  for="filtroFechaActual"/>
                <!--ubicacion origen-->
                <p:outputLabel 
                  for="filtroUbicacionOrigen" 
                  value="#{msg.dtbFltLblUbicacionOrigen} " 
                  styleClass="negrita"/>
                <p:selectOneMenu 
                  id="filtroUbicacionOrigen" 
                  value="#{devolucionTiendaBodegaMB.tipoFacturaSeleccionado}">
                  <f:selectItems 
                    value="#{devolucionTiendaBodegaMB.listaTiposFacturas}" 
                    var="tipoFactura"
                    itemLabel="#{tipoFactura.label}"
                    itemValue="#{tipoFactura.value}"/>
                </p:selectOneMenu>
                <p:message
                  for="filtroUbicacionOrigen"/>
                <!--bodega destino-->
                <p:outputLabel 
                  for="filtroBodegaDestino" 
                  value="#{msg.dtbFltLblBodegaDestino}" 
                  styleClass="negrita"/>
                <p:inputText 
                  id="filtroBodegaDestino" 
                  value="#{devolucionTiendaBodegaMB.consecutivoDocumento}" 
                  maxlength="40" 
                  label="#{msg.gfFltLblConsecutivo}"/>
                <p:message
                  for="filtroBodegaDestino"/>
                <f:facet
                  name="footer">
                  <p:commandButton
                    value="#{msg.gfFltBtnBuscar}"
                    actionListener="#{devolucionTiendaBodegaMB.buscar()}"
                    update="tblDocumentos"/>
                </f:facet>
              </p:panelGrid>
            </p:panel>

            <p:dataTable 
              id="tblDocumentos"
              var="documento" 
              widgetVar="tblDocumentos" 
              value="#{devolucionTiendaBodegaMB.listaRemisiones}" 
              rows="10"
              emptyMessage="#{msg.generalNoDatos}" 
              paginator="true"
              paginatorPosition="bottom"
              paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
              rowsPerPageTemplate="5,10,15">
              <f:facet 
                name="header">
                <div 
                  align="right">
                  <p:outputPanel>
                    <h:outputText 
                      value="#{msg.generalBuscarTodosCampos}: " />
                    <p:inputText 
                      id="globalFilter"
                      onkeyup="PF('tblDocumentos').filter()" 
                      style="width:150px"
                      placeholder="#{msg.generalPalabrasBuscar}" />
                    <p:spacer 
                      width="30">
                    </p:spacer>				
                    <p:commandButton 
                      action="introduccion" 
                      title="#{msg.generalCancelar}" 
                      ajax="false"
                      icon="ui-icon-cancel" 
                      value="#{msg.generalCancelar}" />
                  </p:outputPanel>
                </div>
              </f:facet>
              <!-- SKU -->
              <p:column   
                headerText="#{msg.dtbTblColSKU}"
                sortBy="#{documento.id}"
                filterBy="#{documento.id}"
                filterMatchMode="contains">
                <h:outputText 
                  value="#{documento.id}" />
              </p:column>
              <!-- Nombre del producto -->
              <p:column 
                headerText="#{msg.dtbTblColNombreProducto}"
                sortBy="#{documento.consecutivoDocumento}"
                filterBy="#{documento.consecutivoDocumento}"
                filterMatchMode="contains">
                <h:outputText 
                  value="#{documento.consecutivoDocumento}" />
              </p:column>
              <!-- Cantidad Teórica en Tienda -->
              <p:column 
                headerText="#{msg.dtbTblColCantidadTeoricaTienda}"
                sortBy="#{documento.fechaGeneracion}"
                filterBy="#{documento.fechaGeneracion}"
                filterMatchMode="contains">
                <h:outputText 
                  value="#{documento.fechaGeneracion}"/>
              </p:column>
              <!-- Cantidad a Devolver -->
              <p:column 
                headerText="#{msg.dtbTblColCantidadDevolver}"
                sortBy="#{documento.fechaGeneracion}"
                filterBy="#{documento.fechaGeneracion}"
                filterMatchMode="contains">
                <h:outputText 
                  value="#{documento.fechaGeneracion}"/>
              </p:column>
              <!-- Unidad Venta -->
              <p:column 
                headerText="#{msg.dtbTblColUnidadVenta}"
                sortBy="#{documento.fechaGeneracion}"
                filterBy="#{documento.fechaGeneracion}"
                filterMatchMode="contains">
                <h:outputText 
                  value="#{documento.fechaGeneracion}"/>
              </p:column>
              <!-- Causal de devolución -->
              <p:column 
                headerText="#{msg.dtbTblColCausalDevolucion}"
                sortBy="#{documento.fechaGeneracion}"
                filterBy="#{documento.fechaGeneracion}"
                filterMatchMode="contains">
                <h:outputText 
                  value="#{documento.fechaGeneracion}"/>
              </p:column>
              <!-- Observación -->
              <p:column 
                headerText="#{msg.dtbTblColObservacion}"
                sortBy="#{documento.fechaGeneracion}"
                filterBy="#{documento.fechaGeneracion}"
                filterMatchMode="contains">
                <h:outputText 
                  value="#{documento.fechaGeneracion}"/>
              </p:column>
            </p:dataTable>

            <f:facet
              name="footer">
              <!-- Ingresar devoluciones -->
              <p:commandButton 
                value="#{msg.dtbBtnIngresarDevoluciones}" 
                styleClass="ui-confirmdialog-yes" 
                icon="ui-icon-check" 
                actionListener="#{devolucionTiendaBodegaMB.ingresarDevouciones()}"/>
              <!-- Vista previa -->
              <p:commandButton 
                value="#{msg.dtbBtnVistaPrevia}" 
                ajax="false" 
                icon="ui-icon-document"
                process="@this">
                <p:fileDownload 
                  value="#{devolucionTiendaBodegaMB.generarVistaPrevia()}" />
              </p:commandButton>
            </f:facet>

          </p:panel>

        </p:tab>

      </p:tabView>

    </h:form>

  </ui:define>

</ui:composition>